<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Tilesia - Jeux pédagogiques (2 en 1)</title>
  <style>
    :root{
      --primary:#0a74da;
      --primary-dark:#095aba;
      --bg:#f4f7fb;
      --card:#ffffff;
      --text:#22324a;
      --warn:#b45309;
    }
    *{box-sizing:border-box}
    body{font-family:Arial,Helvetica,sans-serif;margin:0;background:var(--bg);color:var(--text);overflow-x:hidden;}
    .container{max-width:1100px;margin:0 auto;padding:clamp(16px,4vw,32px);}
    .screen{display:none;animation:fadeIn .4s ease-in;}
    .active{display:block;}
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px);}to{opacity:1;transform:translateY(0);}}
    h1,h2,h3{margin:0 0 .6rem}
    .muted{color:#64748b}
    .btn{padding:.7rem 1.1rem;background:#0a74da;color:#fff;border:none;border-radius:10px;cursor:pointer;font-weight:600;box-shadow:0 2px 6px rgba(10,116,218,.25);}
    .btn:hover{background:#095aba;}
    .btn.secondary{background:#e9eef5;color:#18324a;box-shadow:none;}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem;}
    .card{background:#fff;border-radius:14px;box-shadow:0 10px 26px rgba(0,0,0,.08);padding:1rem;}
    .card h3{margin-bottom:.4rem}
    .hero{width:100%;max-width:980px;border-radius:16px;box-shadow:0 10px 26px rgba(0,0,0,.08);display:block;margin:0 auto 12px;object-fit:contain;max-height:60vh;}
    .map{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;margin-top:1rem;}
    .location{background:#fff;padding:1rem;border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.06);text-align:center;cursor:pointer;transition:transform .15s ease,box-shadow .2s ease;}
    .location:hover{transform:translateY(-2px);box-shadow:0 10px 22px rgba(0,0,0,.08);}
    .location img{width:48px;height:48px;margin-bottom:.5rem;}
    .modal{position:fixed;top:5%;left:50%;transform:translateX(-50%);background:#fff;padding:clamp(16px,3vw,24px);border-radius:14px;box-shadow:0 18px 50px rgba(0,0,0,.25);display:none;z-index:1000;width:min(92vw,820px);max-height:90vh;overflow:auto;}
    .modal.active{display:block;}
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;z-index:999;}
    .overlay.active{display:block;}
    .modal img{max-width:100%;max-height:40vh;object-fit:contain;display:block;margin:.5rem 0;}
    .modal-actions{position:sticky;bottom:0;background:#fff;padding-top:.5rem;margin-top:.5rem;}
    .info-log{margin-top:.75rem;font-size:.95rem;color:#0f7a31;}
    .summary{background:#fff;padding:1rem;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.06);}
    .score{margin-top:12px;background:#f0f9ff;border:1px solid #bae6fd;color:#0c4a6e;padding:.75rem 1rem;border-radius:12px;font-weight:600;display:none;}
    .badge{display:inline-block;padding:.35rem .6rem;border-radius:999px;font-size:.9rem;font-weight:700;margin-left:.5rem;}
    .badge.intermediaire{background:#fff7ed;color:#b45309;border:1px solid #fed7aa;}
    .badge.avance{background:#eff6ff;color:#1d4ed8;border:1px solid #93c5fd;}
    .badge.expert{background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0;}
    .errors{margin-top:10px;background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:.75rem 1rem;display:none;}
    .errors h4{margin:.2rem 0 .4rem;}
    .errors ul{margin:.2rem 0 0 1rem;}
    .toggle{margin-top:8px;background:#e9eef5;color:#22324a;}
    .progress{height:10px;background:#e9eef5;border-radius:999px;overflow:hidden;margin:10px 0 18px;}
    .progress>span{display:block;height:100%;background:#0a74da;width:0%;transition:width .25s ease;}
    .tabs{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:.8rem;}
    .tab-btn{padding:.45rem .7rem;border-radius:10px;border:1px solid #d8e0ea;background:#fff;cursor:pointer;font-size:.92rem;color:#213347;}
    .tab-btn.active{background:#0a74da;color:#fff;border-color:#0a74da;}
    .tab-panel{display:none;background:#fff;padding:1rem;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.06);}
    .tab-panel.active{display:block;}
    .option-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:.75rem;margin-top:.75rem;}
    .option{border:1px solid #e6e6e6;border-radius:10px;padding:.75rem;background:#fafafa;}
    .option label{display:block;cursor:pointer;line-height:1.35;}
    .helper{font-size:.92rem;color:#526479;margin:.4rem 0 .1rem}
    .step-actions{display:flex;flex-wrap:wrap;gap:.5rem;justify-content:space-between;margin-top:1rem;}
    .warn{color:#b54708;background:#fff7ed;padding:.5rem .75rem;border-radius:8px;border:1px solid #fde68a;display:none;}
    .small{font-size:.9rem;color:#516170;}
    ul{margin:.4rem 0 0 1rem}
    .footer-space{height:12px;}
    .scenario{background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:1rem;margin-top:12px;}
    .scenario h4{margin:.2rem 0 .4rem}
    .notice-panel{background:#f8fafc;border:1px solid #d1d5db;border-radius:12px;padding:1rem;margin-top:1rem;display:none;}
  </style>
</head>
<body>

<!-- Audio (optionnel) -->
<audio autoplay loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/29/audio_d2d7f6a30e.mp3" type="audio/mpeg">
  Votre navigateur ne supporte pas l'audio.
</audio>
<audio id="clickSound">
  <source src="https://cdn.pixabay.com/download/audio/2022/03/23/audio_32901fa291.mp3" type="audio/mpeg">
  Votre navigateur ne supporte pas l'audio.
</audio>

<!-- ACCUEIL -->
<div id="home" class="screen active">
  <div class="container">
    <img class="hero" src="images/accueil_salle_formation.png" alt="Salle de formation moderne en Guyane avec formateurs et participants">
    <h2>Choisissez votre jeu</h2>
    <div class="grid">
      <div class="card">
        <h3>Jeu n°1 — CCTP Tilesa</h3>
        <p class="muted">Explorez les services du groupe TILESA avec Alex, puis rédigez le cahier des charges via un assistant.</p>
        <button class="btn" onclick="startGame(1)">Lancer le jeu n°1</button>
      </div>
      <div class="card">
        <h3>Jeu n°2 — CCTP Lesati</h3>
        <p class="muted">Suivez Léa, chargée d'affaires, qui doit rédiger un cahier des charges en intégralité pour l'entreprise LESATI.</p>
        <button class="btn" onclick="startGame(2)">Lancer le jeu n°2</button>
      </div>
    </div>
  </div>
</div>

<!-- JEU 1 : écran d'accueil -->
<div id="game1_intro" class="screen">
  <div class="container">
    <img class="hero" src="images/tilesia_accueil_alex.png" alt="Accueil du jeu 1 - Alex TILESA">
    <div style="display:flex; gap:.5rem; margin-top:.5rem;">
      <button class="btn" onclick="goTo('game1')">Démarrer la mission</button>
      <button class="btn secondary" onclick="goTo('home')">⬅ Retour à l'accueil</button>
    </div>
  </div>
</div>

<!-- JEU 1 : carte -->
<div id="game1" class="screen">
  <div class="container">
    <h2>Jeu n°1 — Explorer les services</h2>
    <div class="map">
      <div class="location" onclick="playClick(); openModal('Direction')">
        <img src="https://cdn-icons-png.flaticon.com/512/219/219986.png" alt="Direction">Direction
      </div>
      <div class="location" onclick="playClick(); openModal('Technique')">
        <img src="https://cdn-icons-png.flaticon.com/512/2621/2621140.png" alt="Technique">Service Technique
      </div>
      <div class="location" onclick="playClick(); openModal('Salaries')">
        <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" alt="Salariés">Salariés
      </div>
      <div class="location" onclick="playClick(); openModal('Juridique')">
        <img src="https://cdn-icons-png.flaticon.com/512/2569/2569069.png" alt="Juridique">Juridique
      </div>
    </div>
    <div class="footer-space"></div>
    <button class="btn" onclick="validateCollection(1)">Rédiger le cahier des charges</button>
    <button class="btn secondary" onclick="goTo('home')">⬅ Retour accueil</button>
    <div class="info-log" id="infoLog1"></div>
  </div>
</div>

<!-- Résumé Jeu 1 + Assistant QCM (code inchangé)... -->

<!-- JEU 2 : écran d'accueil -->
<div id="game2_intro" class="screen">
  <div class="container">
    <img class="hero" src="images/lea_centrale_SGO.png" alt="Accueil du jeu 2 - Léa devant la centrale">
    <h2>Jeu n°2 — CCTP Lesati</h2>
    <p>Léa, chargée d'affaires du service production, est volontaire pour réaliser l'expression du besoin.</p>
    <div style="display:flex; gap:.5rem; margin-top:.5rem;">
      <button class="btn" onclick="goTo('game2')">Démarrer la mission</button>
      <button class="btn secondary" onclick="goTo('home')">⬅ Retour à l'accueil</button>
    </div>
  </div>
</div>

<!-- JEU 2 : carte -->
<div id="game2" class="screen">
  <div class="container">
    <h2>Jeu n°2 — Suivez Léa (LESATI)</h2>
    <div class="map">
      <div class="location" onclick="playClick(); openModal('Direction',2)">
        <img src="https://cdn-icons-png.flaticon.com/512/219/219986.png" alt="Direction">Direction (LESATI)
      </div>
      <div class="location" onclick="playClick(); openModal('Service production',2)">
        <img src="https://cdn-icons-png.flaticon.com/512/1995/1995525.png" alt="Production">Service production (LESATI)
      </div>
      <div class="location" onclick="playClick(); openModal('Salaries',2)">
        <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" alt="Salariés">Salariés (LESATI)
      </div>
      <div class="location" onclick="playClick(); openModal('Juridique',2)">
        <img src="https://cdn-icons-png.flaticon.com/512/2569/2569069.png" alt="Juridique">Juridique (LESATI)
      </div>
    </div>
    <div class="footer-space"></div>
    <button class="btn secondary" onclick="goTo('home')">⬅ Retour accueil</button>
    <div class="info-log" id="infoLog2"></div>

    <!-- Bouton rédiger CCTP -->
    <button id="btnCCTP2" class="btn" style="display:none; margin-top:1rem;" onclick="document.getElementById('notice2').style.display='block'">
      Rédiger le cahier des charges
    </button>
    <div id="notice2" class="notice-panel">
      <p><strong>Vous disposez de toutes les informations pour écrire un cahier des charges en 45 minutes.</strong></p>
    </div>
  </div>
</div>

<!-- Le reste du JS et des modales reste inchangé (Direction, Production, Juridique etc.) -->

</body>
</html>
